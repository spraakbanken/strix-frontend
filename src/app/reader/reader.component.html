<div class="clear"></div>
<div class="readerLoading" *ngIf="isLoading">
  <i class="fa fa-spinner fa-pulse"></i>&nbsp;Laddar...
</div>
<div class="readerArea">
  <a id="anchor"></a>
  <a id="readerAnchor"></a>
  <table>
    <tbody>
      <tr>
        <td *ngFor="let m of cmViews;let i = index" class="text_area">
          <div class="text_left_column">
            <div class="text_header">
              <span class="text_title">{{titles[i]}}</span>
              <div class="right_control" (click)="showSidebar = ! showSidebar">
                <i class="fa fa-bars"></i>
              </div>
            </div>
            <cm
              (onSelectionChange)="onSelectionChange($event)"
              (onFocus)="onFocus($event)"
              (onScrollInDocument)="onScrollInDocument($event)"
              (onKeydown)="onKeydown($event)"
              [index]="i"></cm>
            <div class="text_footer">
              <span class="add_bookmark" (click)="addBookmark(i)">
                <i class="fa fa-underline"></i>
              </span>
              <!--<span class="selection_info">
                Markering av token {{selectionStartTokenID}} till {{selectionEndTokenID}}. 
              </span>-->
            </div>
          </div>
          <div class="text_right_column" *ngIf="showSidebar">
            <div class="bookmark" *ngFor="let bookmark of bookmarks" (click)="gotoBookmark(i, bookmark)">
              <!--{{bookmark.style}}-->
              <i *ngIf="bookmark.type == 'user'" class="fa fa-bookmark"></i>
              <i *ngIf="bookmark.type == 'highlight'" class="fa fa-flag" style="color:#337ab7"></i>
              &nbsp;{{bookmark.text}}
            </div>
          </div>
          
        </td>
      </tr>
    </tbody>
  </table>
    <!--<span *ngIf="selection">selection from line {{selection.startRow+1}} to {{selection.endRow+1}}</span><br/>
    <span *ngIf="selection">selection from char {{selection.startChar+1}} to {{selection.endChar+1}}</span><br/>
    <span *ngIf="selection">token {{selectionStartTokenID}} to {{selectionEndTokenID}}</span>-->
  <div class="tokenAnnotationsList"
    *ngIf="!isLoading && showBox && singleWordSelection"
    [style.left.px]="annotationsListLeft"
    [style.top.px]="annotationsListTop">
    <div class="closeBox" (click)="closeBox()">
      <i class="fa fa-window-close-o"></i>
    </div>
    <div class="clear"></div>
    <ul>
      <li
        *ngFor="let annotation of currentAnnotationsKeys">
        <span class="goto_left" (click)="gotoLeft(annotation, currentAnnotations[annotation])">
          <i class="fa fa-angle-left"></i>
        </span>
        <span
          (click)="changeAnnotationHighlight(annotation, currentAnnotations[annotation])">
          {{annotation}}: {{currentAnnotations[annotation]}}
        </span>
        <span class="goto_right" (click)="gotoRight(annotation, currentAnnotations[annotation])">
          <i class="fa fa-angle-right"></i>
        </span>
      </li>
    </ul>
  </div>
</div>